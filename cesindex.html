<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }
        .box {
            width: 60px;
            height: 35px;
            display: flex;
        }
        .box div {
            flex: 1;
            text-align: center;
            line-height: 35px;
        }
    </style>
</head>
<body>
    <div class="box">
        <div class="add">+</div>
        <div class="value">0</div>
        <div class="remove">-</div>
    </div>

    <a href="cesdetail.html">跳转新页面</a>

		<script src="static/js/jquery-2.2.3.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">

        //History 对象包含用户（在浏览器窗口中）访问过的 URL。
        var historyObj = window.history;
console.log(historyObj.length)
        //historyObj.length 返回浏览器历史列表中的 URL 数量。
        //根据historyObj.length 的数量判断是否是第一次进入此页面
        if (historyObj.length == 1) {
            localStorage.test = 1;
            $('.value').text(localStorage.test)
        } else {
            $('.value').text(localStorage.test)
        }

        $('.add').click(function(){
            localStorage.test++;
            $('.value').text(localStorage.test);
        })

        $('.remove').click(function(){
            localStorage.test--;
            $('.value').text(localStorage.test);
        })

        /*
         *  点击某个离开页面的链接
         *  在地址栏中键入了新的 URL
         *  使用前进或后退按钮
         *  关闭浏览器
         *  重新加载页面
         *  满足以上条件都触发此事件
         */
        $(window).unload(function(){
            if (historyObj.length == 1) {
                localStorage.test = 1;
            }
        })
    </script>
</body>
</html>